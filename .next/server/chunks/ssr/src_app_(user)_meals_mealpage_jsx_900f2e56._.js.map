{"version":3,"sources":["../../../../src/app/%28user%29/meals/mealpage.jsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport Link from \"next/link\";\n\nconst API_BASE = process.env.NEXT_PUBLIC_API_BASE || \"http://localhost:5001\";\n\nexport default function MealPage() {\n  const [meals, setMeals] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(\"\");\n\n  const token =\n    typeof window !== \"undefined\" ? localStorage.getItem(\"token\") : null;\n\n  useEffect(() => {\n    if (!token) {\n      window.location.href = \"/login\";\n      return;\n    }\n\n    fetchMeals();\n  }, [token]);\n\n  const fetchMeals = async () => {\n    try {\n      const res = await fetch(`${API_BASE}/api/user/meals`, {\n        headers: { Authorization: `Bearer ${token}` },\n      });\n      const data = await res.json();\n      setMeals(Array.isArray(data) ? data : data.meals || []);\n    } catch (err) {\n      setError(\"Failed to load meals\");\n      console.error(err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const deleteMeal = async (id) => {\n    if (!confirm(\"Delete this meal?\")) return;\n\n    try {\n      const res = await fetch(`${API_BASE}/api/user/meals/${id}`, {\n        method: \"DELETE\",\n        headers: { Authorization: `Bearer ${token}` },\n      });\n\n      if (!res.ok) throw new Error(\"Failed to delete\");\n      setMeals(meals.filter((m) => m.id !== id));\n    } catch (err) {\n      setError(err.message);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center py-12\">\n        <div className=\"inline-flex items-center gap-2\">\n          <div className=\"animate-spin\">‚è≥</div>\n          <span className=\"text-white/70\">Loading meals...</span>\n        </div>\n      </div>\n    );\n  }\n\n  const totalCalories = meals.reduce((sum, m) => sum + (Number(m.calories) || 0), 0);\n\n  return (\n    <div className=\"space-y-8\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-4xl font-bold text-white\">üçΩÔ∏è Meals</h1>\n          <p className=\"text-white/60 mt-2\">Track your daily meals and calories</p>\n        </div>\n        <Link\n          href=\"/meals/new\"\n          className=\"rounded-lg bg-indigo-500 hover:bg-indigo-400 px-6 py-3 text-sm font-semibold transition duration-200\"\n        >\n          + Add Meal\n        </Link>\n      </div>\n\n      {error && (\n        <div className=\"rounded-lg border border-red-500/30 bg-red-500/10 px-4 py-3 text-sm\">\n          <p className=\"text-red-200 font-medium\">‚ö†Ô∏è {error}</p>\n        </div>\n      )}\n\n      {/* Stats Overview */}\n      {meals.length > 0 && (\n        <div className=\"grid gap-4 md:grid-cols-3\">\n          <div className=\"rounded-2xl border border-white/10 bg-white/5 backdrop-blur-sm p-6\">\n            <p className=\"text-sm text-white/60 font-medium\">Total Meals</p>\n            <p className=\"mt-2 text-3xl font-bold\">{meals.length}</p>\n          </div>\n          <div className=\"rounded-2xl border border-white/10 bg-white/5 backdrop-blur-sm p-6\">\n            <p className=\"text-sm text-white/60 font-medium\">Total Calories</p>\n            <p className=\"mt-2 text-3xl font-bold text-indigo-400\">{totalCalories}</p>\n          </div>\n          <div className=\"rounded-2xl border border-white/10 bg-white/5 backdrop-blur-sm p-6\">\n            <p className=\"text-sm text-white/60 font-medium\">Avg per Meal</p>\n            <p className=\"mt-2 text-3xl font-bold text-blue-400\">{Math.round(totalCalories / meals.length)}</p>\n          </div>\n        </div>\n      )}\n\n      {/* Meals List */}\n      <div className=\"rounded-2xl border border-white/10 bg-white/5 backdrop-blur-sm p-6\">\n        {meals.length === 0 ? (\n          <div className=\"flex flex-col items-center justify-center py-12 text-center\">\n            <div className=\"text-4xl mb-3\">üçΩÔ∏è</div>\n            <p className=\"text-white/70 font-medium mb-2\">No meals logged yet</p>\n            <p className=\"text-white/50 text-sm mb-4\">Start tracking by adding your first meal</p>\n            <Link\n              href=\"/meals/new\"\n              className=\"rounded-lg bg-indigo-500 hover:bg-indigo-400 px-4 py-2 text-sm font-semibold transition\"\n            >\n              + Add First Meal\n            </Link>\n          </div>\n        ) : (\n          <div className=\"overflow-x-auto\">\n            <table className=\"w-full text-sm\">\n              <thead>\n                <tr className=\"border-b border-white/10\">\n                  <th className=\"text-left px-4 py-3 text-white/60 font-medium\">Meal Name</th>\n                  <th className=\"text-left px-4 py-3 text-white/60 font-medium\">Calories</th>\n                  <th className=\"text-left px-4 py-3 text-white/60 font-medium\">Date</th>\n                  <th className=\"text-right px-4 py-3 text-white/60 font-medium\">Actions</th>\n                </tr>\n              </thead>\n              <tbody className=\"divide-y divide-white/5\">\n                {meals.map((meal) => (\n                  <tr key={meal.id} className=\"hover:bg-white/5 transition\">\n                    <td className=\"px-4 py-3 font-medium\">{meal.name || \"Untitled Meal\"}</td>\n                    <td className=\"px-4 py-3 text-indigo-400 font-semibold\">\n                      {meal.calories || 0} kcal\n                    </td>\n                    <td className=\"px-4 py-3 text-white/60 text-sm\">\n                      {meal.createdAt ? new Date(meal.createdAt).toLocaleDateString() : \"-\"}\n                    </td>\n                    <td className=\"px-4 py-3 text-right flex gap-2 justify-end\">\n                      <button className=\"text-indigo-400 hover:text-indigo-300 text-xs font-medium transition\">\n                        Edit\n                      </button>\n                      <button\n                        onClick={() => deleteMeal(meal.id)}\n                        className=\"text-red-400 hover:text-red-300 text-xs font-medium transition\"\n                      >\n                        Delete\n                      </button>\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}