{"version":3,"sources":["../../../../src/app/%28user%29/foods/foodpage.jsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState } from \"react\";\n\nconst API_BASE = process.env.NEXT_PUBLIC_API_BASE || \"http://localhost:5001\";\n\nexport default function FoodPage() {\n  const [foods, setFoods] = useState([]);\n  const [name, setName] = useState(\"\");\n  const [calories, setCalories] = useState(\"\");\n  const [editId, setEditId] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(\"\");\n  const [success, setSuccess] = useState(\"\");\n\n  const token =\n    typeof window !== \"undefined\" ? localStorage.getItem(\"token\") : null;\n\n  useEffect(() => {\n    if (!token) {\n      window.location.href = \"/login\";\n      return;\n    }\n\n    fetchFoods();\n  }, [token]);\n\n  const fetchFoods = async () => {\n    try {\n      const res = await fetch(`${API_BASE}/api/user/foods`, {\n        headers: { Authorization: `Bearer ${token}` },\n      });\n      const data = await res.json();\n      setFoods(Array.isArray(data) ? data : []);\n    } catch (err) {\n      setError(\"Failed to load foods\");\n      console.error(err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const submitFood = async (e) => {\n    e.preventDefault();\n    setError(\"\");\n    setSuccess(\"\");\n\n    const url = editId\n      ? `${API_BASE}/api/user/foods/${editId}`\n      : `${API_BASE}/api/user/foods`;\n\n    const method = editId ? \"PUT\" : \"POST\";\n\n    try {\n      const res = await fetch(url, {\n        method,\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`,\n        },\n        body: JSON.stringify({ name, calories: Number(calories) }),\n      });\n\n      if (!res.ok) throw new Error(\"Failed to save food\");\n\n      const data = await res.json();\n\n      if (editId) {\n        setFoods(foods.map((f) => (f.id === editId ? data : f)));\n        setEditId(null);\n        setSuccess(\"Food updated successfully!\");\n      } else {\n        setFoods([...foods, data]);\n        setSuccess(\"Food added successfully!\");\n      }\n\n      setName(\"\");\n      setCalories(\"\");\n    } catch (err) {\n      setError(err.message);\n    }\n  };\n\n  const editFood = (food) => {\n    setEditId(food.id);\n    setName(food.name);\n    setCalories(food.calories);\n    setError(\"\");\n    setSuccess(\"\");\n  };\n\n  const deleteFood = async (id) => {\n    if (!confirm(\"Delete this food?\")) return;\n\n    try {\n      const res = await fetch(`${API_BASE}/api/user/foods/${id}`, {\n        method: \"DELETE\",\n        headers: { Authorization: `Bearer ${token}` },\n      });\n\n      if (!res.ok) throw new Error(\"Failed to delete\");\n      setFoods(foods.filter((f) => f.id !== id));\n      setSuccess(\"Food deleted successfully!\");\n    } catch (err) {\n      setError(err.message);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center py-12\">\n        <div className=\"inline-flex items-center gap-2\">\n          <div className=\"animate-spin\">‚è≥</div>\n          <span className=\"text-white/70\">Loading foods...</span>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-8\">\n      <div>\n        <h1 className=\"text-4xl font-bold text-white\">ü•ó Foods Library</h1>\n        <p className=\"text-white/60 mt-2\">Manage your food database and calories information</p>\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n        {/* Form Section */}\n        <div className=\"lg:col-span-1\">\n          <div className=\"rounded-2xl border border-white/10 bg-white/5 backdrop-blur-sm p-6 sticky top-24\">\n            <h2 className=\"text-xl font-bold text-white mb-4\">\n              {editId ? \"‚úèÔ∏è Edit Food\" : \"‚ûï Add New Food\"}\n            </h2>\n\n            {error && (\n              <div className=\"mb-4 p-3 rounded-lg bg-red-500/10 border border-red-500/30 text-red-200 text-sm font-medium\">\n                {error}\n              </div>\n            )}\n\n            {success && (\n              <div className=\"mb-4 p-3 rounded-lg bg-green-500/10 border border-green-500/30 text-green-200 text-sm font-medium\">\n                {success}\n              </div>\n            )}\n\n            <form onSubmit={submitFood} className=\"space-y-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-white/70 mb-2\">\n                  Food Name\n                </label>\n                <input\n                  className=\"w-full px-3 py-2 rounded-lg bg-white/10 border border-white/20 text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition\"\n                  placeholder=\"e.g. Apple, Chicken breast\"\n                  value={name}\n                  onChange={(e) => setName(e.target.value)}\n                  required\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-white/70 mb-2\">\n                  Calories (per 100g)\n                </label>\n                <input\n                  className=\"w-full px-3 py-2 rounded-lg bg-white/10 border border-white/20 text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition\"\n                  type=\"number\"\n                  placeholder=\"e.g. 52, 165\"\n                  value={calories}\n                  onChange={(e) => setCalories(e.target.value)}\n                  required\n                />\n              </div>\n\n              <button\n                type=\"submit\"\n                className=\"w-full bg-indigo-500 hover:bg-indigo-400 text-white py-2 rounded-lg font-medium transition duration-200\"\n              >\n                {editId ? \"Update Food\" : \"Add Food\"}\n              </button>\n\n              {editId && (\n                <button\n                  type=\"button\"\n                  onClick={() => {\n                    setEditId(null);\n                    setName(\"\");\n                    setCalories(\"\");\n                    setError(\"\");\n                    setSuccess(\"\");\n                  }}\n                  className=\"w-full bg-white/5 hover:bg-white/10 text-white py-2 rounded-lg font-medium border border-white/20 transition duration-200\"\n                >\n                  Cancel\n                </button>\n              )}\n            </form>\n          </div>\n        </div>\n\n        {/* Foods List Section */}\n        <div className=\"lg:col-span-2\">\n          <div className=\"rounded-2xl border border-white/10 bg-white/5 backdrop-blur-sm p-6\">\n            <h3 className=\"text-lg font-semibold text-white mb-4\">Your Foods ({foods.length})</h3>\n            \n            {foods.length === 0 ? (\n              <div className=\"flex flex-col items-center justify-center py-12 text-center\">\n                <div className=\"text-4xl mb-3\">ü•ó</div>\n                <p className=\"text-white/70 font-medium mb-2\">No foods yet</p>\n                <p className=\"text-white/50 text-sm\">Add your first food to get started</p>\n              </div>\n            ) : (\n              <div className=\"overflow-x-auto\">\n                <table className=\"w-full text-sm\">\n                  <thead>\n                    <tr className=\"border-b border-white/10\">\n                      <th className=\"text-left px-4 py-3 text-white/60 font-medium\">Name</th>\n                      <th className=\"text-left px-4 py-3 text-white/60 font-medium\">Calories</th>\n                      <th className=\"text-right px-4 py-3 text-white/60 font-medium\">Actions</th>\n                    </tr>\n                  </thead>\n                  <tbody className=\"divide-y divide-white/5\">\n                    {foods.map((food) => (\n                      <tr key={food.id} className=\"hover:bg-white/5 transition\">\n                        <td className=\"px-4 py-3 text-white font-medium\">{food.name}</td>\n                        <td className=\"px-4 py-3 text-indigo-400 font-semibold\">\n                          {food.calories} kcal/100g\n                        </td>\n                        <td className=\"px-4 py-3 text-right flex gap-2 justify-end\">\n                          <button\n                            onClick={() => editFood(food)}\n                            className=\"text-indigo-400 hover:text-indigo-300 text-xs font-medium transition\"\n                          >\n                            Edit\n                          </button>\n                          <button\n                            onClick={() => deleteFood(food.id)}\n                            className=\"text-red-400 hover:text-red-300 text-xs font-medium transition\"\n                          >\n                            Delete\n                          </button>\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}