{"version":3,"sources":["../../../../src/app/admin/foods/foodpage.jsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState } from \"react\";\n\nconst API_BASE = process.env.NEXT_PUBLIC_BACKEND_URL || \"http://localhost:5001\";\n\nexport default function FoodPage() {\n  const [foods, setFoods] = useState([]);\n  const [name, setName] = useState(\"\");\n  const [calories, setCalories] = useState(\"\");\n  const [editId, setEditId] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(\"\");\n\n  const token =\n    typeof window !== \"undefined\" ? localStorage.getItem(\"token\") : null;\n\n  useEffect(() => {\n    if (!token) {\n      window.location.href = \"/login\";\n      return;\n    }\n\n    fetchFoods();\n  }, [token]);\n\n  const fetchFoods = async () => {\n    try {\n      const res = await fetch(`${API_BASE}/api/foods`, {\n        headers: { Authorization: `Bearer ${token}` },\n      });\n      const data = await res.json();\n      setFoods(Array.isArray(data) ? data : []);\n    } catch (err) {\n      setError(\"Failed to load foods\");\n      console.error(err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const submitFood = async (e) => {\n    e.preventDefault();\n    setError(\"\");\n\n    const url = editId\n      ? `${API_BASE}/api/foods/${editId}`\n      : `${API_BASE}/api/foods`;\n\n    const method = editId ? \"PUT\" : \"POST\";\n\n    try {\n      const res = await fetch(url, {\n        method,\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`,\n        },\n        body: JSON.stringify({ name, calories: Number(calories) }),\n      });\n\n      if (!res.ok) throw new Error(\"Failed to save food\");\n\n      const data = await res.json();\n\n      if (editId) {\n        setFoods(foods.map((f) => (f.id === editId ? data : f)));\n        setEditId(null);\n      } else {\n        setFoods([...foods, data]);\n      }\n\n      setName(\"\");\n      setCalories(\"\");\n    } catch (err) {\n      setError(err.message);\n    }\n  };\n\n  const editFood = (food) => {\n    setEditId(food.id);\n    setName(food.name);\n    setCalories(food.calories);\n  };\n\n  const deleteFood = async (id) => {\n    if (!confirm(\"Are you sure?\")) return;\n\n    try {\n      const res = await fetch(`${API_BASE}/api/foods/${id}`, {\n        method: \"DELETE\",\n        headers: { Authorization: `Bearer ${token}` },\n      });\n\n      if (!res.ok) throw new Error(\"Failed to delete\");\n      setFoods(foods.filter((f) => f.id !== id));\n    } catch (err) {\n      setError(err.message);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"text-lg text-gray-600\">Loading foods...</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-bold text-gray-900\">Foods</h1>\n        <p className=\"text-gray-600 mt-2\">Manage food items and their nutritional values</p>\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n        <div className=\"lg:col-span-1\">\n          <div className=\"bg-white rounded-lg shadow-md p-6 sticky top-6\">\n            <h2 className=\"text-xl font-bold text-gray-900 mb-4\">\n              {editId ? \"Edit Food\" : \"Add New Food\"}\n            </h2>\n\n            {error && (\n              <div className=\"mb-4 p-3 bg-red-50 border border-red-200 text-red-700 rounded-lg text-sm\">\n                {error}\n              </div>\n            )}\n\n            <form onSubmit={submitFood} className=\"space-y-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Food Name\n                </label>\n                <input\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                  placeholder=\"e.g. Apple\"\n                  value={name}\n                  onChange={(e) => setName(e.target.value)}\n                  required\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Calories (per 100g)\n                </label>\n                <input\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                  type=\"number\"\n                  placeholder=\"e.g. 52\"\n                  value={calories}\n                  onChange={(e) => setCalories(e.target.value)}\n                  required\n                />\n              </div>\n\n              <button\n                type=\"submit\"\n                className=\"w-full bg-blue-600 text-white py-2 rounded-lg font-medium hover:bg-blue-700 transition\"\n              >\n                {editId ? \"Update Food\" : \"Add Food\"}\n              </button>\n\n              {editId && (\n                <button\n                  type=\"button\"\n                  onClick={() => {\n                    setEditId(null);\n                    setName(\"\");\n                    setCalories(\"\");\n                  }}\n                  className=\"w-full bg-gray-200 text-gray-700 py-2 rounded-lg font-medium hover:bg-gray-300 transition\"\n                >\n                  Cancel\n                </button>\n              )}\n            </form>\n          </div>\n        </div>\n\n        <div className=\"lg:col-span-2\">\n          <div className=\"bg-white rounded-lg shadow-md overflow-hidden\">\n            {foods.length === 0 ? (\n              <div className=\"p-8 text-center text-gray-600\">\n                <p className=\"text-lg\">No foods available. Add your first food!</p>\n              </div>\n            ) : (\n              <div className=\"overflow-x-auto\">\n                <table className=\"w-full\">\n                  <thead className=\"bg-gray-50 border-b\">\n                    <tr>\n                      <th className=\"px-6 py-3 text-left text-sm font-semibold text-gray-700\">\n                        Food Name\n                      </th>\n                      <th className=\"px-6 py-3 text-left text-sm font-semibold text-gray-700\">\n                        Calories (per 100g)\n                      </th>\n                      <th className=\"px-6 py-3 text-left text-sm font-semibold text-gray-700\">\n                        Actions\n                      </th>\n                    </tr>\n                  </thead>\n                  <tbody className=\"divide-y\">\n                    {foods.map((food) => (\n                      <tr key={food.id} className=\"hover:bg-gray-50 transition\">\n                        <td className=\"px-6 py-4 text-sm font-medium text-gray-900\">\n                          {food.name}\n                        </td>\n                        <td className=\"px-6 py-4 text-sm text-gray-600\">\n                          {food.calories} kcal\n                        </td>\n                        <td className=\"px-6 py-4 text-sm space-x-2\">\n                          <button\n                            onClick={() => editFood(food)}\n                            className=\"text-blue-600 hover:text-blue-800 font-medium\"\n                          >\n                            Edit\n                          </button>\n                          <button\n                            onClick={() => deleteFood(food.id)}\n                            className=\"text-red-600 hover:text-red-800 font-medium\"\n                          >\n                            Delete\n                          </button>\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}